q()
batch <- c(rep(1, 4), rep(2, 4))
batch
devtools::install_github("zhangyuqing/sva-devel")
install.packages("devtools")
devtools::install_github("zhangyuqing/sva-devel")
packageVersion("sva")
count_matrix <- matrix(rnbinom(400, size=10, prob=0.1), nrow=50, ncol=8)
head(count_matrix)
head(count_matrix[1:6])
head(count_matrix[:, 1:6])
head(count_matrix[1,1])
head(count_matrix[1:, 1:6])
head(count_matrix[nrow(count_matrix), 1:6])
count_matrix[, 1:6]
head(count_matrix[1:nrow(count_matrix), 1:6])
head(count_matrix[, 1:6])
A3 <- read.table(text = gsub(",", "\t", readLines("rmats_all/JCEC.raw.input.A3SS.txt")))
A3 <- read.table(text = gsub(",", "\t", readLines("rmats_all/JCEC.raw.input.A3SS.txt")))
A3 <- read.table(text = gsub(",", "\t", readLines("rmats_all/JCEC.raw.input.A3SS.txt")), header=F, fill=T)
head(A3)
A3 <- read.table(text = gsub(",", "\t", readLines("rmats_all/JCEC.raw.input.A3SS.txt")), skip=1, fill=T)
head(A3)
A3c <- A3[, c(2, 57)]
head(A3c)
A3c <- A3[, 2:57]
head(A3c)
batch <- c("Cai", "Cai", "Cai", "Parker", "Parker", "Parker", "Parker", "Parker", "Parker", "Sun", "Sun", "Wang", "Wang", "Cai", "Cai","Cai", "Parker", "Parker", "Parker", "Parker", "Parker", "Parker", "Sun", "Sun", "Wang", "Wang", "Cai", "Cai", "Cai", "Parker", "Parker", "Parker", "Parker", "Parker", "Parker", "Sun", "Sun", "Sun", "Sun", "Wang", "Wang", "Cai", "Cai", "Cai", "Parker", "Parker", "Parker", "Parker", "Parker", "Parker", "Sun", "Sun", "Sun", "Sun", "Wang", "Wang")
cov1 <- c("Col-0", "Col-0", "Col-0", "Col-0", "Col-0", "Col-0", "Col-0", "Col-0", "Col-0", "Col-0", "Col-0", "Col-0", "Col-0", "Col-0", "Col-0", "Col-0", "Col-0", "Col-0", "Col-0", "Col-0", "Col-0", "Col-0", "Col-0", "Col-0", "Col-0", "Col-0", "fio1", "fio1", "fio1", "fio1", "fio1", "fio1", "fio1", "fio1", "fio1", "fio1", "fio1", "fio1", "fio1", "fio1", "fio1", "fio1", "fio1", "fio1", "fio1", "fio1", "fio1", "fio1", "fio1", "fio1", "fio1", "fio1", "fio1", "fio1", "fio1", "fio1")
cov2 <- c(rep(0, 13), rep(1, 13), rep(0, 15), rep(1, 15))
cov2
A3adj <- ComBat_seq()
library(sva)
A3adj <- ComBat_seq()
cover_mat <- cbind(cov1, cov2)
A3adj <- ComBat_seq(A3c, batch=batch, group=NULL, covar_mod=cover_mat)
A3c[is.na(A3c)] <- 0
A3adj <- ComBat_seq(A3c, batch=batch, group=NULL, covar_mod=cover_mat)
head(A3adj)
batch <- c(0, 0, 0, 1, 1, 1, 1, 1, 1, 2, 2, 3, 3, 0, 0,0, 1, 1, 1, 1, 1, 1, 2, 2, 3, 3, 0, 0, 0, 1, 1, 1, 1, 1, 1, 2, 2, 2, 2, 3, 3, 0, 0, 0, 1, 1, 1, 1, 1, 1, 2, 2, 2, 2, 3, 3)
cov1 <- c(0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1)
cov2 <- c(rep(0, 13), rep(1, 13), rep(0, 15), rep(1, 15))
covar_mat <- cbind(cov1, cov2)
A3adj <- ComBat_seq(A3c, batch=batch, group=NULL, covar_mod=cover_mat)
covar_mat
tail(A3c)
A3m <- matrix(A3c)
A3m[is.na(A3m)] <- 0
A3adj <- ComBat_seq(A3m, batch=batch, group=NULL, covar_mod=cover_mat)
batch
head(A3m)
A3m <- as.matrix(A3c)
A3m[is.na(A3m)] <- 0
head(A3m)
A3adj <- ComBat_seq(A3m, batch=batch, group=NULL, covar_mod=cover_mat)
cov1 <- as.numeric(factor(c(0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1)))
cov2 <- as.numeric(factor(c(rep(0, 13), rep(1, 13), rep(0, 15), rep(1, 15))))
covar_mat <- cbind(cov1, cov2)
A3adj <- ComBat_seq(A3m, batch=batch, group=NULL, covar_mod=cover_mat)
cocar_mat
cocer_mat
cover_mat
A3adj <- ComBat_seq(A3m, batch=batch, group=NULL, covar_mod=covar_mat)
A3adj <- ComBat_seq(A3c, batch=batch, group=NULL, covar_mod=covar_mat)
head(A3adj)
batch <- c("Cai", "Cai", "Cai", "Parker", "Parker", "Parker", "Parker", "Parker", "Parker", "Sun", "Sun", "Wang", "Wang", "Cai", "Cai","Cai", "Parker", "Parker", "Parker", "Parker", "Parker", "Parker", "Sun", "Sun", "Wang", "Wang", "Cai", "Cai", "Cai", "Parker", "Parker", "Parker", "Parker", "Parker", "Parker", "Sun", "Sun", "Sun", "Sun", "Wang", "Wang", "Cai", "Cai", "Cai", "Parker", "Parker", "Parker", "Parker", "Parker", "Parker", "Sun", "Sun", "Sun", "Sun", "Wang", "Wang")
cov1 <- c("Col-0", "Col-0", "Col-0", "Col-0", "Col-0", "Col-0", "Col-0", "Col-0", "Col-0", "Col-0", "Col-0", "Col-0", "Col-0", "Col-0", "Col-0", "Col-0", "Col-0", "Col-0", "Col-0", "Col-0", "Col-0", "Col-0", "Col-0", "Col-0", "Col-0", "Col-0", "fio1", "fio1", "fio1", "fio1", "fio1", "fio1", "fio1", "fio1", "fio1", "fio1", "fio1", "fio1", "fio1", "fio1", "fio1", "fio1", "fio1", "fio1", "fio1", "fio1", "fio1", "fio1", "fio1", "fio1", "fio1", "fio1", "fio1", "fio1", "fio1", "fio1")
cov2 <- c(rep(0, 13), rep(1, 13), rep(0, 15), rep(1, 15))
covar_mat <- cbind(cov1, cov2)
A3adj2 <- ComBat_seq(A3c, batch=batch, group=NULL, covar_mod=covar_mat)
head(A3adj)
q()
A3 <- read.table(text = gsub(",", "\t", readLines("rmats_all/JCEC.raw.input.A3SS.txt")), skip=1, fill=T)
A3c <- A3[, c(2, 57)]
head(A3c)
head(A3)
A3c <- A3[, 2:57]
head(A3)
head(A3c)
q()
library(stringr)
q()
a = c("A3SS", "A5SS", "MXE", "RI", "SE")
len(a)
length(a)
i <- "A3SS"
outfile <- str_interp("${i}_combat_adj.txt")
outfile
q()
cov1 <- as.numeric(factor(c(0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1)))
cov2 <- as.numeric(factor(c(rep(0, 13), rep(1, 13), rep(0, 15), rep(1, 15))))
cov_m <- model.matrix(as.formula(cov1+cov2))
readfile <- str_interp("rmats_all/JCEC.raw.input.SE.txt")
library(sva)
library(stringr)
readfile <- str_interp("rmats_all/JCEC.raw.input.SE.txt")
A3 <- read.table(text = gsub(",", "\t", readLines(readfile)), skip=1, fill=T)
A3c <- A3[, c(2:57)]
cov_m <- model.matrix(as.formula(~0+cov1+cov2), data=A3c)
cov_m
batch <- c(0, 0, 0, 1, 1, 1, 1, 1, 1, 2, 2, 3, 3, 0, 0, 0, 1, 1, 1, 1, 1, 1, 2, 2, 3, 3, 0, 0, 0, 1, 1, 1, 1, 1, 1, 2, 2, 2, 2, 3, 3, 0, 0, 0, 1, 1, 1, 1, 1, 1, 2, 2, 2, 2, 3, 3)
A3adj <- ComBat_seq(A3c, batch=batch, group=NULL, covar_mod=cov_m)
outfile <- str_interp("rmats_all/SE_combat_mat.txt")
A3out <- cbind(A3[, 1], A3adj, A3[, c(58,59)])
write.table(A3out, file=outfile, sep="\t", row.names = F, col.names = F)
}
A3out <- cbind(A3[, 1], A3adj, A3[, c(58,59)])
write.table(A3out, file=outfile, sep="\t", row.names = F, col.names = F)
A3adj <- ComBat(dat=A3c, batch=batch, mod=cov_m, par.prior=TRUE)
A3out <- cbind(A3[, 1], A3adj, A3[, c(58,59)])
write.table(A3out, file=outfile, sep="\t", row.names = F, col.names = F)
}
A3out <- cbind(A3[, 1], A3adj, A3[, c(58,59)])
write.table(A3out, file=outfile, sep="\t", row.names = F, col.names = F)
A3adj <- ComBat(dat=A3c, batch=batch, mod=cov_m, par.prior=TRUE, mean.only=TRUE)
A3out <- cbind(A3[, 1], A3adj, A3[, c(58,59)])
write.table(A3out, file=outfile, sep="\t", row.names = F, col.names = F)
q()
glist <- list(sample(letters, 10), sample(letters, 20), sample(letters, 12))
glist
install.packages("RobustRankAggreg")
aggregateRanks(glist = glist, N = length(letters))
library(RobustRankAggreg)
aggregateRanks(glist = glist, N = length(letters))
q()
q()
q()
y <- matrix(rnorm(10*6),10,6)
colnames(y) <- c("A1","A2","A3","B1","B2","B3")
y[,1:3] <- y[,1:3] + 10
y
y <- matrix(rnorm(10*6),10,6)
colnames(y) <- c("A1","A2","A3","B1","B2","B3")

y
